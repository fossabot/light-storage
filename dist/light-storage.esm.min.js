/**
 * light-storage v0.1.0
 * (c) 2019 xunmi
 * Released under the MIT License.
 */
function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function t(e,t){var i=t.get(e);if(!i)throw new TypeError("attempted to get private field on non-instance");return i.get?i.get.call(e):i.value}function i(e,t,i){var a=t.get(e);if(!a)throw new TypeError("attempted to set private field on non-instance");if(a.set)a.set.call(e,i);else{if(!a.writable)throw new TypeError("attempted to set read only private field");a.value=i}return i}var a=function(){function a(){var e=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light-storage";if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),n.set(this,{writable:!0,value:void 0}),r.set(this,{writable:!0,value:void 0}),o.set(this,{writable:!0,value:void 0}),l.set(this,{writable:!0,value:function(){i(e,r,new Set),Object.keys(t(e,n)).forEach(function(i){i.slice(0,t(e,o).length)===t(e,o)&&t(e,r).add(i)})}}),"[object Storage]"!==Object.prototype.toString.call(window.localStorage))throw new TypeError("当前运行环境不支持 localStorage");i(this,n,window.localStorage),this.prefix=s}var s,u,h;return s=a,(u=[{key:"toFullKey",value:function(e){return e.slice(0,t(this,o).length)===t(this,o)?e:"".concat(t(this,o),"-").concat(e)}},{key:"set",value:function(e,i,a){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e=this.toFullKey(e);var l={value:i};"number"==typeof a&&a>=0&&(l.time=o?Date.now():this.getCreatedTime(e)||Date.now(),l.expires=a),t(this,n).setItem(e,JSON.stringify(l)),t(this,r).add(e)}},{key:"get",value:function(e,t){var i=this.getFullData(e);return i&&void 0!==i.value?i.time?Date.now()-i.time<i.expires?i.value:(this.remove(e),t):i.value:t}},{key:"getCreatedTime",value:function(e){var t=this.getFullData(e);if(t&&t.time)return t.time}},{key:"getFullData",value:function(e){if(e=this.toFullKey(e),t(this,r).has(e))return JSON.parse(t(this,n).getItem(e)||"{}")}},{key:"has",value:function(e){return e=this.toFullKey(e),!!t(this,r).has(e)&&void 0!==this.get(e)}},{key:"remove",value:function(e){return e=this.toFullKey(e),!!t(this,r).has(e)&&(t(this,n).removeItem(e),t(this,r).delete(e))}},{key:"clear",value:function(){var e=this;t(this,r).forEach(function(t){return e.remove(t)})}},{key:"prefix",get:function(){return t(this,o)},set:function(e){i(this,o,e),t(this,l).call(this)}}])&&e(s.prototype,u),h&&e(s,h),a}(),n=new WeakMap,r=new WeakMap,o=new WeakMap,l=new WeakMap;a.version="0.1.0";export default a;
