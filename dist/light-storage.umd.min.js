/*!
 * light-storage v0.2.2
 * (c) 2019-2020 xunmi
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).LightStorage=t()}(this,(function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t){var i=t.get(e);if(!i)throw new TypeError("attempted to get private field on non-instance");return i.get?i.get.call(e):i.value}function r(e,t,i){var n=t.get(e);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(e,i);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=i}return i}var o,a,l,u=function(){function o(){var i=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light-storage";t(this,o),s.set(this,{writable:!0,value:void 0}),f.set(this,{writable:!0,value:void 0}),c.set(this,{writable:!0,value:void 0}),v.set(this,{writable:!0,value:function(){r(i,f,new Set),Object.keys(n(i,s)).forEach((function(e){e.slice(0,n(i,c).length)===n(i,c)&&n(i,f).add(e)}))}}),h.set(this,{writable:!0,value:function(t){if(t=i.getFullKey(t),n(i,f).has(t)){var r=n(i,s).getItem(t);try{var o=JSON.parse(r);return"object"===e(o)?o:{value:o}}catch(e){return{value:r}}}}});try{r(this,s,(window||self).localStorage)}catch(e){throw new TypeError("Current environment does not support localStorage")}this.prefix=a}var a,l,u;return a=o,(l=[{key:"getFullKey",value:function(e){return e.slice(0,n(this,c).length)===n(this,c)?e:"".concat(n(this,c),"-").concat(e)}},{key:"set",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e=this.getFullKey(e);var a={value:t,version:o.version};if(i){if("number"!=typeof i||i<0)throw new TypeError("Please enter a valid time limit");a.time=r?Date.now():this.getCreatedTime(e)||Date.now(),a.timeLimit=i}n(this,s).setItem(e,JSON.stringify(a)),n(this,f).add(e)}},{key:"get",value:function(e,t){var i=n(this,h).call(this,e);return i&&void 0!==i.value?i.time?Date.now()-i.time<i.timeLimit?i.value:(this.remove(e),t):i.value:t}},{key:"getCreatedTime",value:function(e){var t=n(this,h).call(this,e);if(t&&t.time)return t.time}},{key:"has",value:function(e){return e=this.getFullKey(e),!!n(this,f).has(e)&&void 0!==this.get(e)}},{key:"remove",value:function(e){return e=this.getFullKey(e),!!n(this,f).has(e)&&(n(this,s).removeItem(e),n(this,f).delete(e))}},{key:"clear",value:function(){var e=this;n(this,f).forEach((function(t){return e.remove(t)}))}},{key:"prefix",get:function(){return n(this,c)},set:function(e){r(this,c,e),n(this,v).call(this)}}])&&i(a.prototype,l),u&&i(a,u),o}(),s=new WeakMap,f=new WeakMap,c=new WeakMap,v=new WeakMap,h=new WeakMap;return l=void 0,(a="version")in(o=u)?Object.defineProperty(o,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):o[a]=l,u.version="0.2.2",u}));
